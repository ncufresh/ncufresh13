(function(a){a.game=function(b){function n(b){a("#game_message_box").children().text(b);a("#game_message_box").show("fast",function(){setTimeout(function(){a("#game_message_box").fadeOut()},2E3)})}function I(c,d,e){b.useCarding=!0;switch(d){case "1":b.useCarding=!1;break;case "2":1!=b.doubleBuff&&(b.doubleBuff=1,g("using_card","pid="+c+"&mid="+e,h[d]));b.useCarding=!1;break;case "3":2!=b.diceNumber&&(b.diceNumber=2,a('<img class="game_dice" src="'+bUrl+'/file/img/game/dice.gif" />').appendTo("#game_dice_box"),
g("using_card","pid="+c+"&mid="+e,h[d]));b.useCarding=!1;break;case "4":g("using_card","pid="+c+"&mid="+e,h[d]);break;case "5":r(!0);b.walking=!0;a("#game_dice_box").hide();a(".point").click(function(){g("using_card","pid="+c+"&mid="+a(this).attr("mapID"),h[d]);b.walking=!1;a("#game_dice_box").show();r(!1)});n("\u4f60\u5728\u597d\u53cb\u7684\u8def\u4e0a\u653e\u7f6e\u4e86\u8def\u969c!");break;case "6":r(!0);b.walking=!0;a("#game_dice_box").hide();a(".point").click(function(){g("using_card","pid="+
c+"&mid="+a(this).attr("mapID"),h[d]);b.walking=!1;a("#game_dice_box").show();r(!1);for(var e=0;e<mapUsingCard.length;e++)if(a(this).attr("mapID")==mapUsingCard[e].mid){for(var f=mapUsingCard.length;0<f;f--)a(".game_stop").eq(f).attr("mid")==mapUsingCard[e].mid&&a(".game_stop").eq(f).remove();return!0}});break;case "7":for(e=userProfile.position;userProfile.position=Math.floor(Math.random()*mapData.length+1),userProfile.position==e;);e=m.css("top");m.animate({top:"-500px"}).animate({top:e});e=[];
0!=mapData[userProfile.position-1].n_0&&e.push(0);0!=mapData[userProfile.position-1].n_1&&e.push(1);0!=mapData[userProfile.position-1].n_2&&e.push(2);0!=mapData[userProfile.position-1].n_3&&e.push(3);userProfile.direction=e[Math.floor(Math.random()*e.length)];b.mapDisX=0-mapData[userProfile.position-1].location_x+b.heroLeft;b.mapDisY=0-mapData[userProfile.position-1].location_y+b.heroTop;e=b.mapDisX-parseInt(a("#"+b.mapID).css("left").replace("px",""));var k=b.mapDisY-parseInt(a("#"+b.mapID).css("top").replace("px",
""));a(".game_friend").delay(200).animate({left:"+="+e+"px",top:"+="+k+"px"});a(".game_friend_text").delay(200).animate({left:"+="+e+"px",top:"+="+k+"px"});a(".game_stop").delay(200).animate({left:"+="+e+"px",top:"+="+k+"px"});a("#"+b.mapID).delay(200).animate({left:"+="+e+"px",top:"+="+k+"px"},"normal","swing",function(){g("using_card","pid="+c+"&mid="+userProfile.position,h[d]);g("change_location","location="+userProfile.position+"&direction="+userProfile.direction,q)});break;case "8":1!=b.moneyGod&&
(b.moneyGod=1,g("using_card","pid="+c+"&mid=0",h[d]));b.useCarding=!1;break;case "9":x(c,d);break;case "10":x(c,d);break;default:g("using_card","pid="+c+"&mid="+e,h[d])}}function A(c){function d(){k.attr("src",bUrl+"/file/img/game/destiny/destiny"+p+".png");f++;10>p?p++:p=1;if(90>f)setTimeout(d,30);else{var b=a('<img src="'+bUrl+'/file/img/game/destiny/destiny_ball.png"/>').css({left:"60%",position:"absolute",top:"53%",width:"8px",height:"8px"}).appendTo(e);setTimeout(function(){k.fadeOut(300);b.fadeOut(300,
function(){g("change_location","location="+userProfile.position+"&direction="+userProfile.direction,q);g("get_special","type="+c,B);k.remove();b.remove();e.remove()})},100)}}b.walking=!0;a("#game_dice_box").hide();var e=a("<div></div>").css({width:"100%",height:"100%",zIndex:"20",position:"absolution"}).appendTo("#"+b.gameMainID);if(1==c){var k=a('<img src="'+bUrl+'/file/img/game/destiny/destiny1.png"/>').css({left:"50%",position:"absolute",top:"22%",width:"234px",zIndex:"20",height:"198px"}).appendTo(e),
p=1,f=0;d()}else if(2==c)var l=a('<img src="'+bUrl+'/file/img/game/destiny/destiny_card.png"/>').css({left:"363px",position:"absolute",top:"100%",width:"210px",zIndex:"20",height:"281px"}).appendTo(e).animate({top:"10%"},600,"swing",function(){l.animate({opacity:"0.8"}).attr("src",bUrl+"/file/img/game/destiny/destiny_card2.png").animate({opacity:"1.0"},"normal","swing",function(){l.fadeOut(300,function(){g("get_special","type="+c,B);l.remove();e.remove();g("change_location","location="+userProfile.position+
"&direction="+userProfile.direction,q)})})});else b.walking=!1,a("#game_dice_box").show(),g("get_special","type="+c,J)}function q(c){c=jQuery.parseJSON(c);friendData=c.friendData;userProfile=c.userProfile;C();b.walking=!1;a("#game_dice_box").show()}function K(c){var d=jQuery.parseJSON(c),e=d.message.split("|");c=a("<div></div>").css({position:"relative",width:"100%",height:"100%"});a('<img src="'+bUrl+'/file/img/game/question.gif" style="width: 100%; height: 100%; position: absolute left: 0px"/>').appendTo(c);
a('<div id="game_question_q"></div>').text(e[0]).appendTo(c);if("c"==e[1])for(var k=0;k<parseInt(e[2]);k++)a('<div number="'+(k+1)+'"></div>').addClass("game_question_a").css({top:140+50*k+"px"}).text(e[4+k]).appendTo(c).click(function(){a(this).attr("number")==e[3]?(v.fadeOut(),n("\u4f60\u7b54\u5c0d\u4e86!!\u7372\u5f97"+d.values+"\u7a4d\u6728"),1==d.action_type&&(0<d.values&&1==b.doubleBuff)&&(n("\u4f60\u7b54\u5c0d\u4e86!\u4e26\u4e14\u7372\u5f97"+d.values+"*2\u7684\u734e\u52f5"),b.doubleBuff=0),
1==d.action_type&&g("add_pu_pu","ss="+d.ss+"&pupu="+d.values,w)):(v.fadeOut(),n("\u7b54\u6848\u662f: "+e[3+parseInt(e[3])]))});L(c);g("change_location","location="+userProfile.position+"&direction="+userProfile.direction,q)}function w(c){userProfile=jQuery.parseJSON(c);a("#"+b.moneyID).text(userProfile.money)}function M(a,b){g("get_gift_to","uid_to="+a+"&cid="+b,function(a){friendData=jQuery.parseJSON(a)})}function g(b,d,e){d=d+"&s="+s;a.post(ajaxAction[b]+".html",d,e)}b=a.extend({gameMainID:"game_main",
mapID:"game_map",cardbarOpenID:"game_cardbar_open",cardbarID:"game_cardbar",moneyID:"game_money",energyID:"game_energy",stepCounterID:"game_stepNumber",friendBackID:"game_friend_box",friendBarID:"game_friend_bar",friendLeftID:"game_friend_bar_left",friendRightID:"game_friend_bar_right",achievementID:"game_achievement",mapDisX:0,mapDisY:0,diceNumber:1,heroLeft:0,heroTop:0,doubleBuff:0,moneyGod:0,cardbarOpen:!1,useCarding:!1,walking:!1,sending:!1},b);var v=a('<div id="game_window_back"></div>').hide().appendTo("#"+
b.gameMainID),y=a('<div id="game_window_back"></div>').hide().appendTo("#"+b.gameMainID).click(function(a){y.fadeOut();g("get_user_profile","",w)}),t=a("#"+b.friendBackID).appendTo("#"+b.gameMainID).click(function(c){0!=a(c.target).parents("#game_window_divShow").length||"game_window_divShow"==c.target.id||b.sending||(b.useCarding=!1,t.fadeOut(),b.chooseFriend=-1)}),D=a('<div id="game_window_divShow"></div>').appendTo(v),E=a('<div id="game_window_divShow"></div>').appendTo(y),u=function(c){if(c){a("#"+
b.cardbarID).empty().animate({left:"10%"});c=Array(shopCard.length);for(var d=1;d<shopCard.length;d++){for(var e=0,k=0;k<userCard.length;k++)userCard[k].type==d&&e++;k=a("<div></div>").addClass("game_cardbox").appendTo("#"+b.cardbarID).mouseenter(function(){a(".game_cardbox").css({top:"0px"});b.useCarding||a(this).animate({top:"-20px"})}).mouseleave(function(){a(this).css({top:"0px"})});a('<img src="'+bUrl+"/file/img/game/card/"+d+'.jpg" ></img>').addClass("game_card").appendTo(k);c[d-1]=a("<div>"+
e+"</div>").addClass("game_cardnumber").appendTo(k)}a(c).each(function(c){a(this).click(function(){if(!b.useCarding)for(var a=0;a<userCard.length;a++)if(userCard[a].type==c+1)return I(userCard[a].pid,userCard[a].type,0),!0})})}else a("#"+b.cardbarID).animate({left:"-85%"},400,"swing",function(){a(this).empty()})},C=function(){a(".game_friend").fadeOut().remove();a(".game_friend_text").fadeOut().remove();for(var c=0;c<friendData.length;c++)a('<img src="'+bUrl+"/file/img/personal/"+friendData[c].skin_id+
'.gif"></img>').addClass("game_friend").css({left:mapData[friendData[c].position-1].location_x-mapData[userProfile.position-1].location_x+b.heroLeft-25+"px",top:mapData[friendData[c].position-1].location_y-mapData[userProfile.position-1].location_y+b.heroTop-50+"px"}).appendTo("#"+b.gameMainID),a("<div></div>").addClass("game_friend_text").text(friendData[c].nickname).css({left:mapData[friendData[c].position-1].location_x-mapData[userProfile.position-1].location_x+b.heroLeft-40+"px",top:mapData[friendData[c].position-
1].location_y-mapData[userProfile.position-1].location_y+b.heroTop-70+"px"}).appendTo("#"+b.gameMainID)},z=function(a){g("get_question","mid="+a,K)},L=function(a){D.empty();v.fadeIn();a.appendTo(D)},F=function(a){E.empty();y.fadeIn();a.appendTo(E)},x=function(c,d){a("#"+b.friendBarID).empty().css({position:"absolute",width:180*friendData.length+"px",height:"204px",top:"0px",left:"0px"});for(var e=0;e<friendData.length+5;e++){var k=t.children("#game_window_divShow");if(e>=friendData.length)break;var p=
a("<div></div>").css({width:"100%",height:"100%",zIndex:"50",position:"absolute",top:"0px",left:"0px"}),f=a('<div number="'+e+'"></div>').css({width:"149px",height:"204px",overflow:"hidden",position:"relative","float":"left",margin:"0px 15px"}).click(function(){if(9==d||10==d)g("using_card","pid="+c+"&mid="+friendData[a(this).attr("number")].uid,h[d]),t.fadeOut(),p.remove(),k.children().show()}).appendTo("#"+b.friendBarID);a('<img src="'+bUrl+'/file/img/profile/person_box.png"/>').css({width:"149px",
height:"204px"}).appendTo(f);0==d&&0==c&&friendData[e].last_send.substr(8,2)!=serverTime.substr(8,2)&&a('<img src="'+bUrl+'/file/img/game/give_gift.png" id="'+e+'"/>').css({top:"150px",left:"36px",width:"70px",height:"70px",position:"absolute"}).click(function(){b.sending=!0;var c=a(this).attr("id"),e=friendData[c].uid;k.children().hide();p.appendTo(k);a('<img src="'+bUrl+'/file/img/game/giveGift_back.png"/>').css({width:"100%",height:"100%",position:"absolute",top:"0px",left:"0px"}).appendTo(p);
for(var d=a("<div></div>").css({width:"561px",height:"297px",zIndex:"50",position:"absolute",margin:"0 auto",top:"54px",left:"15px",overflow:"hidden"}).appendTo(p),f=1;f<shopCard.length+1;f++){var g=a("<div></div>").css({width:"14.6%",height:"50%","float":"left",margin:"0 1%",position:"relative"}).appendTo(d);a('<img src="'+bUrl+'/file/img/game/giveGift_frame.png"/>').css({width:"100%",height:"100%",position:"relative"}).appendTo(g);a('<img src="'+bUrl+"/file/img/game/card/"+f+'.jpg" number="'+f+
'"></img>').css({width:"65px",height:"129px",position:"absolute",top:"10px",left:"9px"}).click(function(){b.sending=!1;M(e,a(this).attr("number"));friendData[c].last_send=serverTime;t.fadeOut();p.remove();k.children().show()}).appendTo(g)}}).appendTo(f);a('<img src="'+bUrl+"/file/img/personal/"+friendData[e].skin_id+'.gif"/>').css({position:"absolute",left:"28px",top:"21px",height:"139px"}).appendTo(f);a("<p>"+friendData[e].nickname+"</p>").css({position:"absolute",left:"0px",top:"153px",width:"149px",
textAlign:"center"}).appendTo(f)}t.fadeIn();a("#"+b.friendLeftID).click(function(){0>=parseInt(a("#"+b.friendBarID).css("left").replace("px",""))+180&&a("#"+b.friendBarID).stop().animate({left:"+=180px"})});a("#"+b.friendRightID).click(function(){0-parseInt(a("#"+b.friendBarID).css("left").replace("px",""))+parseInt(a("#game_friend_out").css("width").replace("px",""))+180<=parseInt(a("#"+b.friendBarID).css("width").replace("px",""))&&a("#"+b.friendBarID).stop().animate({left:"-=180px"})})},G=function(){var c=
userProfile.energy;4<=c&&(c=4);a("#"+b.energyID).attr("src",bUrl+"/file/img/game/battery"+c+".gif")},r=function(c){if(c)for(c=0;c<mapData.length;c++){var d=a('<div class="point" mapID="'+(c+1)+'"></div>').css({left:parseInt(b.mapDisX)+parseInt(mapData[c].location_x)-53+"px",top:parseInt(b.mapDisY)+parseInt(mapData[c].location_y)-53+"px",position:"absolute"}).appendTo("#"+b.gameMainID);a('<img src="'+bUrl+'/file/img/game/point.png" ></img>').appendTo(d)}else a(".point").remove()};a("#"+b.moneyID).text(userProfile.money);
var m=a('<img src="'+bUrl+"/file/img/personal/"+userProfile.skin_id+'.gif"/>').addClass("game_person").appendTo("#"+b.gameMainID);b.heroLeft=parseInt(m.css("left").replace("px",""));b.heroTop=parseInt(m.css("top").replace("px",""));m.css({left:b.heroLeft-parseInt(m.css("width").replace("px",""))/2,top:b.heroTop-parseInt(m.css("height").replace("px",""))/2});G();a("#"+b.cardbarOpenID).click(function(){b.useCarding||b.walking||(b.cardbarOpen=!b.cardbarOpen,u(b.cardbarOpen))});a("#"+b.cardbarOpenID).mouseover(function(){a(this).attr("src",
bUrl+"/file/img/game/cards_light.png")});a("#"+b.cardbarOpenID).mouseout(function(){a(this).attr("src",bUrl+"/file/img/game/cards.png")});a("#game_give_gift").click(function(){b.useCarding||b.walking||x(0,0)});var H=!1;a("#game_setting").click(function(){(H=!H)?a("#game_setting_bar").animate({left:"-="+a("#game_setting_bar").css("width")}):a("#game_setting_bar").animate({left:"100%"})});a("#"+b.achievementID).click(function(){if(!b.useCarding&&!b.walking){var c=a('<div id="game_window_back"></div>').hide().appendTo("#"+
b.gameMainID).fadeIn().click(function(a){c.fadeOut()});a("#game_ach_box").show().appendTo(c);var d=a(".game_ach_detail"),e=0,k=achievement.chance,g=achievement.destiny,f=achievement.question,l=achievement.money,h;for(h in k)parseInt(userProfile.data_chance)>=parseInt(h)?d.eq(e++).css({color:"green"}):d.eq(e++).css({color:"red"});for(h in g)parseInt(userProfile.data_destiny)>=parseInt(h)?d.eq(e++).css({color:"green"}):d.eq(e++).css({color:"red"});for(h in f)parseInt(userProfile.data_question)>=parseInt(h)?
d.eq(e++).css({color:"green"}):d.eq(e++).css({color:"red"});for(h in l)parseInt(userProfile.data_money)>=parseInt(h)?d.eq(e++).css({color:"green"}):d.eq(e++).css({color:"red"});a.bar(a("#game_ach_cnt"))}});a("#game_rule").click(function(){var b=a('<div id="game_rule_window"></div>');a('<img src="'+bUrl+'/file/img/game/instruction.png" />').css({height:"400px",width:"600px",position:"absolute",left:"0px"}).appendTo(b);var d=a("<p></p>").appendTo(b);d.append('<div style="font-size=20px">\u904a\u6232\u898f\u5247\uff1a</div><ol><li>\u884c\u8d70\u65b9\u6cd5\uff1a\u4ee5\u9ab0\u5b50\u7684\u9ede\u6578\u4f5c\u70ba\u524d\u9032\u6b65\u6578\u3002</li><li>\u521d\u59cb\u91d1\u984d\uff1a\u6bcf\u4f4d\u73a9\u5bb6\u6709150\u500b\u7a4d\u6728\u3002</li><li>\u6a5f\u6703\u3001\u547d\u904b\uff1a\u7576\u73a9\u5bb6\u5230\u9054\u6a5f\u6703\u6216\u547d\u904b\u683c\u6642\uff0c\u5c07\u6703\u96a8\u6a5f\u7372\u5f97\u6216\u6263\u9664\u7a4d\u6728\uff0c\u6216\u662f\u9047\u5230\u554f\u7b54\u3001\u7a81\u767c\u72c0\u6cc1\u3002</li><li>\u767b\u5165\u734e\u52f5\uff1a\u7b2c\u4e00\u6b21\u767b\u5165\u6703\u8d08\u9001100\u683c\u80fd\u91cf\uff01\u9664\u6b64\u4e4b\u5916\u6bcf\u65e5\u767b\u5165\u53ef\u7372\u5f97\u7a4d\u67285\u500b\uff0c\u4e5f\u6703\u4f9d\u7167\u904a\u6232\u6642\u9593\u7d66\u4e88\u4e00\u5b9a\u7a4d\u6728\u3002</li><li>\u904a\u6232\u9650\u5236\uff1a\u5927\u5bcc\u7fc1\u6709\u9ad4\u529b\u9650\u5236\uff0c\u6bcf\u6b21\u9ab0\u9ab0\u5b50\u6703\u6d88\u8017\u4e00\u683c\u80fd\u91cf\uff0c\u80fd\u91cf\u7e3d\u5171\u6709\u56db\u683c\uff0c\u82e5\u80fd\u91cf\u6d88\u8017\u6b86\u76e1\uff0c\u5f97\u900f\u904e\u597d\u53cb\u9001\u4f60\u80fd\u91cf\u5361\uff0c\u9019\u6a23\u624d\u80fd\u7e7c\u7e8c\u904a\u6232\u5594\uff01</li><li>\u7279\u6b8a\u9053\u5177\uff1a\u904a\u6232\u4e2d\u670912\u7a2e\u9053\u5177\uff0c\u53ef\u4ee5\u900f\u904e\u6210\u5c31\u9054\u6210\u5f97\u5230\uff0c\u4e5f\u53ef\u4ee5\u5f9e\u597d\u53cb\u7684\u9001\u79ae\u4e2d\u53d6\u5f97\uff01</li></ol>');
d.css({paddingTop:"72px",paddingLeft:"44px",paddingRight:"40px",textAlign:"left",position:"absolute"});F(b)});(function(){b.mapDisX=0-mapData[userProfile.position-1].location_x+b.heroLeft;b.mapDisY=0-mapData[userProfile.position-1].location_y+b.heroTop;a("#"+b.mapID).css({left:b.mapDisX+"px",top:b.mapDisY+"px"});for(var c=[],d=0;d<mapData.length;d++)4==mapData[d].special_type&&c.push(d+1);var e=function(d,h){var f=[];if(0==d){if(4==mapData[userProfile.position-1].special_type&&h){var l=m.css("top");
m.animate({top:"-500px"}).animate({top:l});0!=mapData[userProfile.position-1].n_0&&f.push(0);0!=mapData[userProfile.position-1].n_1&&f.push(1);0!=mapData[userProfile.position-1].n_2&&f.push(2);0!=mapData[userProfile.position-1].n_3&&f.push(3);userProfile.direction=f[Math.floor(Math.random()*f.length)];b.mapDisX=0-mapData[userProfile.position-1].location_x+b.heroLeft;b.mapDisY=0-mapData[userProfile.position-1].location_y+b.heroTop;f=b.mapDisX-parseInt(a("#"+b.mapID).css("left").replace("px",""));l=
b.mapDisY-parseInt(a("#"+b.mapID).css("top").replace("px",""));a(".game_friend").delay(200).animate({left:"+="+f+"px",top:"+="+l+"px"});a(".game_friend_text").delay(200).animate({left:"+="+f+"px",top:"+="+l+"px"});a(".game_stop").delay(200).animate({left:"+="+f+"px",top:"+="+l+"px"});a("#"+b.mapID).delay(200).animate({left:"+="+f+"px",top:"+="+l+"px"},400,"swing",function(){g("change_location","location="+userProfile.position+"&direction="+userProfile.direction,q);a("#"+b.stepCounterID).text(d).hide();
return!0})}else 3==mapData[userProfile.position-1].special_type?z(userProfile.position):3>mapData[userProfile.position-1].special_type&&0<mapData[userProfile.position-1].special_type?A(mapData[userProfile.position-1].special_type):4<mapData[userProfile.position-1].special_type?A(mapData[userProfile.position-1].special_type):z(userProfile.position);a("#"+b.stepCounterID).text(d).hide();return!0}a("#"+b.stepCounterID).text(d);d--;h?(l=m.css("top"),m.animate({top:"-500px"}).animate({top:l}),0!=mapData[userProfile.position-
1].n_0&&f.push(0),0!=mapData[userProfile.position-1].n_1&&f.push(1),0!=mapData[userProfile.position-1].n_2&&f.push(2),0!=mapData[userProfile.position-1].n_3&&f.push(3),userProfile.direction=f[Math.floor(Math.random()*f.length)]):(0!=mapData[userProfile.position-1].n_0&&2!=userProfile.direction&&f.push(0),0!=mapData[userProfile.position-1].n_1&&3!=userProfile.direction&&f.push(1),0!=mapData[userProfile.position-1].n_2&&0!=userProfile.direction&&f.push(2),0!=mapData[userProfile.position-1].n_3&&1!=
userProfile.direction&&f.push(3),userProfile.direction=f[Math.floor(Math.random()*f.length)],userProfile.position=mapData[userProfile.position-1]["n_"+userProfile.direction]);b.mapDisX=0-mapData[userProfile.position-1].location_x+b.heroLeft;b.mapDisY=0-mapData[userProfile.position-1].location_y+b.heroTop;f=b.mapDisX-parseInt(a("#"+b.mapID).css("left").replace("px",""));l=b.mapDisY-parseInt(a("#"+b.mapID).css("top").replace("px",""));a(".game_friend").delay(200).animate({left:"+="+f+"px",top:"+="+
l+"px"});a(".game_friend_text").delay(200).animate({left:"+="+f+"px",top:"+="+l+"px"});a(".game_stop").delay(200).animate({left:"+="+f+"px",top:"+="+l+"px"});a("#"+b.mapID).delay(200).animate({left:"+="+f+"px",top:"+="+l+"px"},400,"swing",function(){for(var f=0;f<mapUsingCard.length;f++)if(userProfile.position==mapUsingCard[f].mid){for(var l=mapUsingCard.length;0<l;l--)a(".game_stop").eq(l).attr("mid")==mapUsingCard[f].mid&&a(".game_stop").eq(l).remove();z(userProfile.position);g("hit_stop","location="+
userProfile.position+"&direction="+userProfile.direction,q);a("#"+b.stepCounterID).text(f).hide();return!0}4==mapData[userProfile.position-1].special_type&&!0!=h?(userProfile.position=c[Math.floor(Math.random()*c.length)],e(d,!0)):e(d,!1)})};a("#game_dice_box").click(function(){r(!1);if(!b.walking)if(0<userProfile.energy){b.cardbarOpen=!1;u(b.cardbarOpen);for(var c=0,d=0;d<b.diceNumber;d++)c+=Math.floor(6*Math.random()+1);b.walking=!0;a("#game_dice_box").hide();e(c);a("#"+b.stepCounterID).text(c).show();
userProfile.energy--;G();a("#game_dice_box").empty();a('<img class="game_dice" src="'+bUrl+'/file/img/game/dice.gif" />').appendTo("#game_dice_box");1==b.moneyGod&&(g("add_pu_pu","ss="+b.ss+"&pupu="+c,w),n("\u8ca1\u795e\u9644\u8eab\u7372\u8d08"+c+"\u7a4d\u6728"),b.moneyGod=0);"1"==userProfile.badgod&&(g("bad_god","money="+(0-c)),n("\u88ab\u8870\u795e\u9644\u8eab\u5c0e\u81f4\u907a\u5931\u4e86"+c+"\u7a4d\u6728"),a("#"+b.moneyID).text(parseInt(userProfile.money)-parseInt(c)),userProfile.badgod=0);2==
b.diceNumber&&(b.diceNumber=1)}else n("\u4f60\u6c92\u6709\u80fd\u91cf\u56c9!")})})();C();(function(){a("#game_get_gift").click(function(b){0==a(b.target).parents("#game_gift_box").length&&"game_gift_box"!=b.target.id&&a("#game_get_gift").fadeOut()});a("#game_gift_items").css({width:120*giftQuery.length+"px"});for(var b=Array(giftQuery.length),d=0;d<giftQuery.length;d++)b[d]=a('<div class="game_gift_item"></div>').appendTo(a("#game_gift_items")),a("<div>"+giftQuery[d].nickname+"</div>").css({textAlign:"center"}).appendTo(b[d]),
a('<img src="'+bUrl+"/file/img/game/card/"+giftQuery[d].cid+'.jpg" ></img>').addClass("game_gift_card").appendTo(b[d]),a('<img src="'+bUrl+'/file/img/game/getGift_getButton.gif" card="'+giftQuery[d].pid+'"></img>').addClass("game_gift_button").click(function(){a(this).unbind();g("return_receive_gift","pid="+a(this).attr("card"),function(a){a=jQuery.parseJSON(a);userCard=a.userCard;userProfile=a.userProfile});a(this).parents(".game_gift_item").fadeOut()}).appendTo(b[d])})();g("get_check_code","",function(a){s=
jQuery.parseJSON(a)[0]});(function(){for(var c=0;c<mapUsingCard.length;c++)a('<img src="'+bUrl+'/file/img/game/stop.png" class="game_stop" mid="'+mapUsingCard[c].mid+'"/>').css({left:mapData[mapUsingCard[c].mid-1].location_x-mapData[userProfile.position-1].location_x+b.heroLeft-39+"px",top:mapData[mapUsingCard[c].mid-1].location_y-mapData[userProfile.position-1].location_y+b.heroTop-98+"px"}).appendTo("#"+b.gameMainID)})();var B=function(c){c=jQuery.parseJSON(c);0<c.values?n("\u4f60\u7372\u5f97\u4e86"+
c.values+"\u7a4d\u6728"):n("\u4f60\u640d\u5931\u4e86"+Math.abs(c.values)+"\u7a4d\u6728");a("#"+b.moneyID).text(parseInt(userProfile.money)+parseInt(c.values))},J=function(c){var d=jQuery.parseJSON(c);c=a("<div></div>").css({width:"100%",height:"100%",position:"relative"});a('<img src="'+bUrl+'/file/img/game/situation.gif" />').css({position:"absolute",width:"100%",height:"100%",left:"0px"}).appendTo(c);var e=a('<div id="game_everyday_text"></div>').css({position:"absolute",top:"28%",width:"542px",
left:"25px"}).text(d.message).appendTo(c);1==d.action_type&&0<d.values&&1==b.doubleBuff?(a('<img src="'+bUrl+'/file/img/game/double.png" id="game_double_buff"/>').appendTo(e),g("get_user_profile","",w),0==b.doubleBuff,g("change_location","location="+userProfile.position+"&direction="+userProfile.direction,q)):2==d.action_type?(e=m.css("top"),userProfile.position=d.values,m.animate({top:"-500px"}).animate({top:e}),b.mapDisX=0-mapData[userProfile.position-1].location_x+b.heroLeft,b.mapDisY=0-mapData[userProfile.position-
1].location_y+b.heroTop,d=b.mapDisX-parseInt(a("#"+b.mapID).css("left").replace("px","")),e=b.mapDisY-parseInt(a("#"+b.mapID).css("top").replace("px","")),a(".game_friend").delay(200).animate({left:"+="+d+"px",top:"+="+e+"px"}),a(".game_friend_text").delay(200).animate({left:"+="+d+"px",top:"+="+e+"px"}),a(".game_stop").delay(200).animate({left:"+="+d+"px",top:"+="+e+"px"}),a("#"+b.mapID).delay(200).animate({left:"+="+d+"px",top:"+="+e+"px"},400,"swing",function(){})):g("change_location","location="+
userProfile.position+"&direction="+userProfile.direction,q);F(c)},h=[function(a){a=jQuery.parseJSON(a);userCard=a.userCard;userProfile=a.userProfile;u(!0);b.useCarding=!1},function(a){h[0](a)},function(a){h[0](a)},function(a){h[0](a)},function(c){var d=userProfile.money;c=jQuery.parseJSON(c);userCard=c.userCard;userProfile=c.userProfile;u(!0);d=userProfile.money-d;n("\u4f60\u7372\u5f97\u4e86 "+d+"\u7a4d\u6728");a("#"+b.moneyID).text(userProfile.money);b.useCarding=!1},function(a){h[0](a)},function(a){h[0](a)},
function(a){h[0](a)},function(a){a=jQuery.parseJSON(a);userCard=a.userCard;userProfile=a.userProfile;b.ss=a.ss;u(!0);b.moneyGod=0;b.useCarding=!1},function(a){h[0](a)},function(a){h[0](a)},function(a){h[0](a)}]}})(jQuery);
(function(a){a(document).ready(function(){"TRUE"==daily&&a('<div id="game_everyday_text">\u606d\u559c\u7372\u5f97\u6bcf\u65e5\u767b\u5165\u734e\u52f5!</div>').css({top:"12px",position:"absolute",left:"211px"}).appendTo(a("#game_loading"))});a(window).load(function(){a("#game_loading").delay(3E3).fadeOut(1E3,function(){a(this).remove()});a.game()})})(jQuery);